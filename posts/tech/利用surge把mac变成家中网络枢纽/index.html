<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<title>利用 Surge 把 Mac 变成家中网络枢纽 | Mingyu&#39;s Blog</title>
<meta name="keywords" content="Surge, Switch, 教程">
<meta name="description" content="前情提要 今年 618 大促入手人生第一台掌机游戏机 Nintendo Switch OLED 版（日版），Switch 游戏可以从eshop 中下载，但是国内直接访问下载 eshop 中的游戏速度可以说">
<meta name="author" content="
作者:&nbsp;Mingyu">
<link rel="canonical" href="http://www.lmingyu.tech/posts/tech/%E5%88%A9%E7%94%A8surge%E6%8A%8Amac%E5%8F%98%E6%88%90%E5%AE%B6%E4%B8%AD%E7%BD%91%E7%BB%9C%E6%9E%A2%E7%BA%BD/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e51f2bbeebf49a16882d47d54d99eefe5c9192727e0ff926042b354a6827eb1c.css" integrity="sha256-5R8rvuv0mhaILUfVTZnu/lyRknJ&#43;D/kmBCs1Smgn6xw=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://www.lmingyu.tech/img/top.webp">
<link rel="icon" type="image/png" sizes="16x16" href="http://www.lmingyu.tech/img/top.webp">
<link rel="icon" type="image/png" sizes="32x32" href="http://www.lmingyu.tech/img/top.webp">
<link rel="apple-touch-icon" href="http://www.lmingyu.tech/Q.gif">
<link rel="mask-icon" href="http://www.lmingyu.tech/Q.gif">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="利用 Surge 把 Mac 变成家中网络枢纽" />
<meta property="og:description" content="前情提要 今年 618 大促入手人生第一台掌机游戏机 Nintendo Switch OLED 版（日版），Switch 游戏可以从eshop 中下载，但是国内直接访问下载 eshop 中的游戏速度可以说" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.lmingyu.tech/posts/tech/%E5%88%A9%E7%94%A8surge%E6%8A%8Amac%E5%8F%98%E6%88%90%E5%AE%B6%E4%B8%AD%E7%BD%91%E7%BB%9C%E6%9E%A2%E7%BA%BD/" />
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/OLj9G3-2022-07-02-201031.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-02T15:03:17&#43;08:00" />
<meta property="article:modified_time" content="2022-07-05T22:20:17&#43;08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/OLj9G3-2022-07-02-201031.png" />
<meta name="twitter:title" content="利用 Surge 把 Mac 变成家中网络枢纽"/>
<meta name="twitter:description" content="前情提要 今年 618 大促入手人生第一台掌机游戏机 Nintendo Switch OLED 版（日版），Switch 游戏可以从eshop 中下载，但是国内直接访问下载 eshop 中的游戏速度可以说"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "📚文章",
      "item": "http://www.lmingyu.tech/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "💻技术",
      "item": "http://www.lmingyu.tech/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "利用 Surge 把 Mac 变成家中网络枢纽",
      "item": "http://www.lmingyu.tech/posts/tech/%E5%88%A9%E7%94%A8surge%E6%8A%8Amac%E5%8F%98%E6%88%90%E5%AE%B6%E4%B8%AD%E7%BD%91%E7%BB%9C%E6%9E%A2%E7%BA%BD/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "利用 Surge 把 Mac 变成家中网络枢纽",
  "name": "利用 Surge 把 Mac 变成家中网络枢纽",
  "description": "前情提要 今年 618 大促入手人生第一台掌机游戏机 Nintendo Switch OLED 版（日版），Switch 游戏可以从eshop 中下载，但是国内直接访问下载 eshop 中的游戏速度可以说",
  "keywords": [
    "Surge", "Switch", "教程"
  ],
  "articleBody": "前情提要 今年 618 大促入手人生第一台掌机游戏机 Nintendo Switch OLED 版（日版），Switch 游戏可以从eshop 中下载，但是国内直接访问下载 eshop 中的游戏速度可以说是龟速。得知 Switch 中 eshop 需要和 Steam 一样开启游戏加速器才能正常使用。但是 UU 加速器使用包年需要 283 RMB，就不舍得（对，我就是那种买贵东西不眨眼，但是买便宜附属品时斤斤计较的人🙄）。\n我记起来之前看过其他人用 Surge 把 Mac 当中代理转发让 Apple TV 可以顺利地访问（科学上网），我到网上查找教程，果然真的可以，于是就有了这篇教程，也是做一个记录，以便以后翻阅。\n前期环境准备 Surge for Mac （通过 Mac 电脑作为中间商为其他设备作为代理转发） Mac Studio （接着网线的，配置好之后是不能关机的，我试过 Mac 电脑休眠之后 Surge 软件是会自动退出的，所以需要保持电脑不要休眠，如果休眠了需要重新开启才能继续使用） M1 Max 运存：64 G 系统：masOS Monterey 12.4 机场订阅地址（没有的话需要自己找一下😂，科学上网必备） 以下教程默认已经准备好以上的 3 个条件\nSurge Surge 介绍 总览 Surge 是一个网络开发和代理工具。他是为开发者打造的工具，所以使用时需要具备一定的专业知识。\n以下四种是 Surge 的核心工作流。\n接管：接管设备发起的网络连接。Surge 支持代理服务器和虚拟网卡两种接管模式。 处理：可以修改已经接管的网络请求和响应。包括 URL 重定向、本地文件映射、使用 JavaScript 自定义修改等多种方法。 转发：可以将已接管的网络请求转发到其他代理服务器。这可以是全局转发，也可以通过灵活的规则系统来确定出站策略。 拦截：可以拦截并保存网络请求和响应的数据，也可以通过 MITM 解密 HTTPS 流量。 我们这里主要使用的是转发\n特点 我使用 Surge 这个软件主要是被它这几个特点吸引的：\n高性能、稳定、高效率：Surge 可以在耗费极少资源并且保持高稳定性的前提下轻松处理网络数据，配合 M1 芯片更加节能和稳定 增强模式：Surge 会设置一个虚拟网络去接管所有的网络请求，尤其是那些对 Web 代理支持不好的软件。 网关模式：Surge Mac 可以当做三层网关去处理同网络下其他设备的网络请求。（简单来说就可以当做一个路由器，成为家中网络枢纽） Surge 下载与购买 下载 Surge for Mac 可以直接在 Surge 官网下载，我下载的版本是最新版，Surge 4.6.1 (1718) ，下载完之后是一个压缩包，解压之后把 app 拖到应用程序中即可打开使用了。\n但是下载之后并不能直接科学上网的，还是需要花钱进行购买，到官网进行授权购买，购买 1 台设备授权 49.99 美刀，3 台设备授权 69.99 美刀，5 台设备授权 99.99 美刀，支持支付宝付款，这里我买的是 3 台设备授权（我是想在过年回家也可以给家里也弄一个就买的3台），实花 471.13 RMB （根据当时汇率波动，心疼啊），可以根据个人需求进行购买，至少购买 1 台。\n购买之后就可以根据购买时的邮箱地址和购买之后给你邮箱发的激活码对 Surge 进行激活。\nSurge 接管 Mac 网络 接下来就可以让 Surge 接管 Mac 电脑的网络了（让 Mac 可以科学上网），这时候就需要你有机场的订阅地址了。\n往 Surge 中添加配置文件\n这里使用的是从 URL 安装配置文件，你也可以通过文件进行导入或者自己手动添加配置。\n如果你订阅的机场是直接有 Surge 的订阅地址可以直接添加，如果没有，但是有v2ray、ss 、trojan 的订阅也是可以的，通过第三方订阅转换生成 Surge 可以识别的 URL 。\n选择基础模式，如果你想自定义你想要的特定节点可以选择进阶模式 在订阅链接中粘贴上你订阅机场的订阅地址 在客户端下拉框中选择 Surge4 点击红色生成订阅链接就可以生成定制订阅 URL，点击复制 打开 Surge 主界面左下角更多，选择设置中的配置\n选择从 URL 安装配置文件\n粘贴你刚才由第三方生成的配置文件订阅地址，然后选择完成，等待一会 Surge 就会对规则策略进行导入\n等 Surge 识别完成之后会出现一个新的托管配置，选中这个新的配置，并点击右下角应用\n回到 Surge 主界面，选中代理下的策略，选择 规则判定 ，这时检测一下科学上网是否成功了，如果不行，点击标签栏的 Surge 检查一下是否勾选了 设置为系统代理 和 增强模式，没有勾选可以勾选上，并重启一下 Surge\n到此你的 Mac 就可以愉快地上网了\n让 Mac 成为家中网络枢纽 上面的步骤已经可以让 Mac 电脑愉快地上网了，但是独乐了不如众乐乐，那怎么让家里其他设备也可以愉快地上网呢？\n这里就需要用到 Surge 的 DHCP 服务器这个功能了，也就是上面介绍过的网关模式。\n设置电脑 IP 为静态IP 打开 系统偏好设置-网络，选择以太网（也就是网线接口） 配置 IPv4 选择 使用 DHCP（手动设定地址） 我的路由器是 192.168.1.1 所以 IP 地址我就填 192.168.1.2，只用修改最后一位在 2-225 之间就行。（如果你的路由器是 192.168.0.1 你的 IP 地址就可以填 192.168.0.2，以此类推） 随后选择 应用 注意：这里设置之前先把 Surge 设置为系统代理先关掉，开启会影响后面 ip 地址设置，建议先关掉，后面设置完之后再开启。\n关闭路由器 DHCP 登录到你们家的路由器管理后台，在管理页面中找到 DHCP 服务器设置，把路由器的 DHCP 关掉（一般路由器都会有这个选项）\n打开 Surge DHCP 选项 在Surge左侧 设备 里，点开后最下面有 DHCP 服务器 开关，点开后选择下一步。\n插网线的选择 Ethernet ，点击下一步。\nSurge 会检测当前网络环境是否有 DHCP 设置，如果上面你正确关闭了 路由器 DHCP 这里应该能直接生成配置\n选择 Surge 默认的设置点击完成即可，如果你发现这里路由地址为空（我一开始在这里卡了很久，后面发现选错了网络设备，选成了Ethernet Adapter (en6)），你就要检查一下哪里步骤出错了\n启动完 DHCP 服务器之后可以看到设备列表没有任何设备，这时需要重启一下路由器或者让你想使用的设备重新连接一下wifi，就可以在新增设备中看到\n添加设备成员 想要科学上网的设备可以右键选择设备名，然后选择 使用 Surge 作为网关，然后设备重新连接wifi或者关闭路由器 wifi 再打开即可。\n没连接上会显示等待连接，这里建议把设置固定 IP 地址也选上，这时官网推荐的做法，方便以后设备管理和连接。\n苹果手机和平板，由于注重隐私的原因会默认在连接 Wifi 的时候选上使用私有无线局域网地址进行连接（使用私有地址有助于减少不同无线局域网对 iPhone 的跟踪），这里需要把这个选项关掉重新连接 wifi 才能让 Surge 识别出你的设备。\n如果不清楚 IP 地址具体对应哪台设备，可以到路由器管理后台查看或者根据此 IP 的制造商进行推断。\n最后推荐将设备连接Wifi的IPV4地址改为手动，因为你如果你启用了自动DHCP的话，有可能下次连接这个WIFI时IP地址就会改变，如果连接失败，可以按照以下的配置将IPV4地址改为手动即可。\n至此，家里的想要一起科学上网的设备都可以通过 Mac 电脑这个网络枢纽一起愉快玩耍了！\n特殊情况 一开始使用的时候，我遇到过用surge作为网关的 Mac 可以打开网页的 youtube 视频并且能观看，但是家里其他设备通过wifi连接的缺不能访问 google，检查一下是可以打开 youtube App，但是只能看到视频的缩略图，进一步点击打开视频观看，却始终是 loading状态，无法观看。奇怪的是可以打开Netflix，正常看剧。\n这种情况查找到解决的办法是，在你需要访问 YouTube 的设备上把连接的 wifi 的 DNS配置修改一下，从自动改为手动，并添加一个 DNS 服务器 192.0.2.2\n至于为什么设置为这个DNS地址我也不是很清楚，只知道手册上是这样写的🐶，这样就把 YouTube 不能访问的问题就解决了！\n总结 以后有其他设备想要愉快上网，都可以通过这台被 Surge 附魔的 Mac 电脑作为转发代理，省下了加速器的年费，还比加速器好使，覆盖范围更广。\n这篇文章只是简单使用了 Surge 的简单功能（规则访问策略并没有定制化），用户还可以对 Surge 进行很多定制化的改造，这些更深入的功能就等以后慢慢发掘吧，先去愉快地玩我新到的 Switch 啦，有什么好玩的游戏，欢迎推荐！\n参考资料 Surge 把你的 Mac 变成最强路由器 Surge 使用手册 Surge 教程 Surge 论坛 家庭网络部署心得 ",
  "wordCount" : "3023",
  "inLanguage": "en",
  "image":"https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/OLj9G3-2022-07-02-201031.png","datePublished": "2022-07-02T15:03:17+08:00",
  "dateModified": "2022-07-05T22:20:17+08:00",
  "author":{
    "@type": "Person",
    "name": "Mingyu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://www.lmingyu.tech/posts/tech/%E5%88%A9%E7%94%A8surge%E6%8A%8Amac%E5%8F%98%E6%88%90%E5%AE%B6%E4%B8%AD%E7%BD%91%E7%BB%9C%E6%9E%A2%E7%BA%BD/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mingyu's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://www.lmingyu.tech/img/top.webp"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://www.lmingyu.tech" accesskey="h" title="Mingyu&#39;s Blog (Alt + H)">Mingyu&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://www.lmingyu.tech/search" title="🔍搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍搜索</span>
                </a>
            </li>
            <li>
                <a href="http://www.lmingyu.tech/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="http://www.lmingyu.tech/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="http://www.lmingyu.tech/archives/" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="http://www.lmingyu.tech/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="http://www.lmingyu.tech/about" title="🙋🏻‍♂️关于">
                    <span>🙋🏻‍♂️关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
    <header class="post-header">
        <div class="breadcrumbs"><a href="http://www.lmingyu.tech">Home</a>&nbsp;»&nbsp;<a href="http://www.lmingyu.tech/posts/">📚文章</a>&nbsp;»&nbsp;<a href="http://www.lmingyu.tech/posts/tech/">💻技术</a></div>
        <h1 class="post-title">
            利用 Surge 把 Mac 变成家中网络枢纽
        </h1>
        <div class="post-meta">










创建:&nbsp;<span title='2022-07-02 15:03:17 +0800 +0800'>2022-07-02</span>&nbsp;|&nbsp;更新:&nbsp;2022-07-05&nbsp;|&nbsp;字数:&nbsp;3023&nbsp;字&nbsp;|&nbsp;阅读约耗时: 7&nbsp;分钟&nbsp;|&nbsp;
作者:&nbsp;Mingyu

|&nbsp;本文被浏览了&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;次
        </div>
    </header> 
<figure class="entry-cover1"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/OLj9G3-2022-07-02-201031.png" alt="">
        
</figure><aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e5%89%8d%e6%83%85%e6%8f%90%e8%a6%81" aria-label="前情提要">前情提要</a></li>
                    <li>
                        <a href="#%e5%89%8d%e6%9c%9f%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87" aria-label="前期环境准备">前期环境准备</a></li>
                    <li>
                        <a href="#surge" aria-label="Surge">Surge</a><ul>
                            
                    <li>
                        <a href="#surge-%e4%bb%8b%e7%bb%8d" aria-label="Surge 介绍">Surge 介绍</a><ul>
                            
                    <li>
                        <a href="#%e6%80%bb%e8%a7%88" aria-label="总览">总览</a></li>
                    <li>
                        <a href="#%e7%89%b9%e7%82%b9" aria-label="特点">特点</a></li></ul>
                    </li>
                    <li>
                        <a href="#surge-%e4%b8%8b%e8%bd%bd%e4%b8%8e%e8%b4%ad%e4%b9%b0" aria-label="Surge 下载与购买">Surge 下载与购买</a></li></ul>
                    </li>
                    <li>
                        <a href="#surge-%e6%8e%a5%e7%ae%a1-mac-%e7%bd%91%e7%bb%9c" aria-label="Surge 接管 Mac 网络">Surge 接管 Mac 网络</a></li>
                    <li>
                        <a href="#%e8%ae%a9-mac-%e6%88%90%e4%b8%ba%e5%ae%b6%e4%b8%ad%e7%bd%91%e7%bb%9c%e6%9e%a2%e7%ba%bd" aria-label="让 Mac 成为家中网络枢纽">让 Mac 成为家中网络枢纽</a><ul>
                            
                    <li>
                        <a href="#%e8%ae%be%e7%bd%ae%e7%94%b5%e8%84%91-ip-%e4%b8%ba%e9%9d%99%e6%80%81ip" aria-label="设置电脑 IP 为静态IP">设置电脑 IP 为静态IP</a></li>
                    <li>
                        <a href="#%e5%85%b3%e9%97%ad%e8%b7%af%e7%94%b1%e5%99%a8-dhcp" aria-label="关闭路由器 DHCP">关闭路由器 DHCP</a></li>
                    <li>
                        <a href="#%e6%89%93%e5%bc%80-surge-dhcp-%e9%80%89%e9%a1%b9" aria-label="打开 Surge DHCP 选项">打开 Surge DHCP 选项</a></li>
                    <li>
                        <a href="#%e6%b7%bb%e5%8a%a0%e8%ae%be%e5%a4%87%e6%88%90%e5%91%98" aria-label="添加设备成员">添加设备成员</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%89%b9%e6%ae%8a%e6%83%85%e5%86%b5" aria-label="特殊情况">特殊情况</a></li>
                    <li>
                        <a href="#%e6%80%bb%e7%bb%93" aria-label="总结">总结</a></li>
                    <li>
                        <a href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" aria-label="参考资料">参考资料</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>
    <div class="post-content"><h1 id="前情提要">前情提要<a hidden class="anchor" aria-hidden="true" href="#前情提要">#</a></h1>
<blockquote>
<p>今年 618 大促入手人生第一台掌机游戏机 Nintendo Switch OLED 版（日版），Switch 游戏可以从eshop 中下载，但是国内直接访问下载 eshop 中的游戏速度可以说是龟速。得知 Switch 中 eshop 需要和 Steam 一样开启游戏加速器才能正常使用。但是 UU 加速器使用包年需要 283 RMB，就不舍得（对，我就是那种买贵东西不眨眼，但是买便宜附属品时斤斤计较的人🙄）。</p>
<p>我记起来之前看过其他人用 Surge 把 Mac 当中代理转发让 Apple TV 可以顺利地访问（科学上网），我到网上查找教程，果然真的可以，于是就有了这篇教程，也是做一个记录，以便以后翻阅。</p>
</blockquote>
<h1 id="前期环境准备">前期环境准备<a hidden class="anchor" aria-hidden="true" href="#前期环境准备">#</a></h1>
<ul>
<li>Surge for Mac （通过 Mac 电脑作为中间商为其他设备作为代理转发）</li>
<li>Mac Studio （接着网线的，配置好之后是不能关机的，我试过 Mac 电脑休眠之后 Surge 软件是会自动退出的，所以需要保持电脑不要休眠，如果休眠了需要重新开启才能继续使用）
<ul>
<li>M1 Max</li>
<li>运存：64 G</li>
<li>系统：masOS Monterey 12.4</li>
<li><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/ANNW94-2022-07-02-162212.png" alt="ANNW94-2022-07-02-162212"  />
</li>
</ul>
</li>
<li>机场订阅地址（没有的话需要自己找一下😂，科学上网必备）</li>
</ul>
<p><strong>以下教程默认已经准备好以上的 3 个条件</strong></p>
<hr>
<h1 id="surge">Surge<a hidden class="anchor" aria-hidden="true" href="#surge">#</a></h1>
<h2 id="surge-介绍">Surge 介绍<a hidden class="anchor" aria-hidden="true" href="#surge-介绍">#</a></h2>
<h3 id="总览">总览<a hidden class="anchor" aria-hidden="true" href="#总览">#</a></h3>
<blockquote>
<p>Surge 是一个网络开发和代理工具。他是为开发者打造的工具，所以使用时需要具备一定的专业知识。</p>
</blockquote>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/7xbnGO-2022-07-02-165248.png" alt="7xbnGO-2022-07-02-165248"  />
</p>
<p>以下四种是 Surge 的核心工作流。</p>
<ul>
<li>接管：接管设备发起的网络连接。Surge 支持代理服务器和虚拟网卡两种接管模式。</li>
<li>处理：可以修改已经接管的网络请求和响应。包括 URL 重定向、本地文件映射、使用 JavaScript 自定义修改等多种方法。</li>
<li>转发：可以将已接管的网络请求转发到其他代理服务器。这可以是全局转发，也可以通过灵活的规则系统来确定出站策略。</li>
<li>拦截：可以拦截并保存网络请求和响应的数据，也可以通过 MITM 解密 HTTPS 流量。</li>
</ul>
<p>我们这里主要使用的是转发</p>
<h3 id="特点">特点<a hidden class="anchor" aria-hidden="true" href="#特点">#</a></h3>
<p>我使用 Surge 这个软件主要是被它这几个特点吸引的：</p>
<ul>
<li>高性能、稳定、高效率：Surge 可以在耗费极少资源并且保持高稳定性的前提下轻松处理网络数据，配合 M1 芯片更加节能和稳定</li>
<li>增强模式：Surge 会设置一个虚拟网络去接管所有的网络请求，尤其是那些对 Web 代理支持不好的软件。</li>
<li>网关模式：<strong>Surge Mac 可以当做三层网关去处理同网络下其他设备的网络请求。</strong>（简单来说就可以当做一个路由器，成为家中网络枢纽）</li>
</ul>
<h2 id="surge-下载与购买">Surge 下载与购买<a hidden class="anchor" aria-hidden="true" href="#surge-下载与购买">#</a></h2>
<p>下载 Surge for Mac 可以直接在 <a href="https://nssurge.com/">Surge 官网</a>下载，我下载的版本是最新版，Surge 4.6.1 (1718) ，下载完之后是一个压缩包，解压之后把 app 拖到应用程序中即可打开使用了。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/enlBCc-2022-07-02-170049.png" alt="enlBCc-2022-07-02-170049"  />
</p>
<p>但是下载之后并不能直接科学上网的，还是需要花钱进行购买，到官网进行授权购买，购买 1 台设备授权 49.99 美刀，3 台设备授权 69.99 美刀，5 台设备授权 99.99 美刀，<strong>支持支付宝付款</strong>，这里我买的是 3 台设备授权（我是想在过年回家也可以给家里也弄一个就买的3台），实花 471.13 RMB （根据当时汇率波动，心疼啊），可以根据个人需求进行购买，至少购买 1 台。</p>
<p>购买之后就可以根据购买时的邮箱地址和购买之后给你邮箱发的激活码对 Surge 进行激活。</p>
<hr>
<h1 id="surge-接管-mac-网络">Surge 接管 Mac 网络<a hidden class="anchor" aria-hidden="true" href="#surge-接管-mac-网络">#</a></h1>
<blockquote>
<p>接下来就可以让 Surge 接管 Mac 电脑的网络了（让 Mac 可以科学上网），这时候就需要你有机场的订阅地址了。</p>
</blockquote>
<p><strong>往 Surge 中添加配置文件</strong></p>
<p>这里使用的是从 URL 安装配置文件，你也可以通过文件进行导入或者自己手动添加配置。</p>
<p>如果你订阅的机场是直接有 Surge 的订阅地址可以直接添加，如果没有，但是有v2ray、ss 、trojan 的订阅也是可以的，通过<a href="https://bianyuan.xyz/">第三方订阅转换</a>生成 Surge 可以识别的 URL 。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/5WspOo-2022-07-02-172841.png" alt="5WspOo-2022-07-02-172841"  />
</p>
<ol>
<li>选择基础模式，如果你想自定义你想要的特定节点可以选择进阶模式</li>
<li>在订阅链接中粘贴上你订阅机场的订阅地址</li>
<li>在客户端下拉框中选择 Surge4</li>
<li>点击红色生成订阅链接就可以生成定制订阅 URL，点击复制</li>
</ol>
<p>打开 Surge 主界面左下角更多，选择设置中的<strong>配置</strong></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/FPlXiy-2022-07-02-173426.png" alt="FPlXiy-2022-07-02-173426"  />
</p>
<p>选择<strong>从 URL 安装配置文件</strong></p>
<img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/PFS43A-2022-07-02-173704.png" alt="PFS43A-2022-07-02-173704"  />
<p>粘贴你刚才由第三方生成的配置文件订阅地址，然后选择完成，等待一会 Surge 就会对规则策略进行导入</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/EgzLZb-2022-07-02-174004.png" alt="EgzLZb-2022-07-02-174004"  />
</p>
<p>等 Surge 识别完成之后会出现一个新的托管配置，选中这个新的配置，并点击右下角<strong>应用</strong></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/MePj6m-2022-07-02-175029.png" alt="MePj6m-2022-07-02-175029"  />
</p>
<p>回到 Surge 主界面，选中代理下的策略，选择 <strong>规则判定</strong> ，这时检测一下科学上网是否成功了，如果不行，点击标签栏的 Surge 检查一下是否勾选了 <strong>设置为系统代理</strong> 和 <strong>增强模式</strong>，没有勾选可以勾选上，并重启一下 Surge</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/9d3KT2-2022-07-02-175857.png" alt="9d3KT2-2022-07-02-175857"  />
</p>
<p><strong>到此你的 Mac 就可以愉快地上网了</strong></p>
<hr>
<h1 id="让-mac-成为家中网络枢纽">让 Mac 成为家中网络枢纽<a hidden class="anchor" aria-hidden="true" href="#让-mac-成为家中网络枢纽">#</a></h1>
<p>上面的步骤已经可以让 Mac 电脑愉快地上网了，但是独乐了不如众乐乐，那怎么让家里其他设备也可以愉快地上网呢？</p>
<p>这里就需要用到 Surge 的 DHCP 服务器这个功能了，也就是上面介绍过的<strong>网关模式</strong>。</p>
<h2 id="设置电脑-ip-为静态ip">设置电脑 IP 为静态IP<a hidden class="anchor" aria-hidden="true" href="#设置电脑-ip-为静态ip">#</a></h2>
<ol>
<li>打开 <strong>系统偏好设置-网络</strong>，选择以太网（也就是网线接口）</li>
<li>配置 IPv4 选择 <strong>使用 DHCP（手动设定地址）</strong></li>
<li>我的路由器是 192.168.1.1 所以 IP 地址我就填 192.168.1.2，只用修改最后一位在 2-225 之间就行。（如果你的路由器是 192.168.0.1 你的 IP 地址就可以填 192.168.0.2，以此类推）</li>
<li>随后选择 <strong>应用</strong></li>
</ol>
<p>注意：这里设置之前先把 Surge 设置为系统代理先关掉，开启会影响后面 ip 地址设置，建议先关掉，后面设置完之后再开启。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/uTcDOP-2022-07-02-181712.png" alt="uTcDOP-2022-07-02-181712"  />
</p>
<h2 id="关闭路由器-dhcp">关闭路由器 DHCP<a hidden class="anchor" aria-hidden="true" href="#关闭路由器-dhcp">#</a></h2>
<p>登录到你们家的路由器管理后台，在管理页面中找到 DHCP 服务器设置，把路由器的 DHCP 关掉（一般路由器都会有这个选项）</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/kiUr1q-2022-07-02-182242.png" alt="kiUr1q-2022-07-02-182242"  />
</p>
<h2 id="打开-surge-dhcp-选项">打开 Surge DHCP 选项<a hidden class="anchor" aria-hidden="true" href="#打开-surge-dhcp-选项">#</a></h2>
<p>在Surge左侧 <strong>设备</strong> 里，点开后最下面有 <strong>DHCP 服务器</strong> 开关，点开后选择下一步。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/XaJAvP-2022-07-02-183102.png" alt="XaJAvP-2022-07-02-183102"  />
</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/AKpMao-2022-07-02-183144.png" alt="AKpMao-2022-07-02-183144"  />
</p>
<p>插网线的选择 <strong>Ethernet</strong> ，点击下一步。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/uPhRre-2022-07-02-183408.png" alt="uPhRre-2022-07-02-183408"  />
</p>
<p>Surge 会检测当前网络环境是否有 DHCP 设置，如果上面你正确关闭了 路由器 DHCP 这里应该能直接生成配置</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/iME4T0-2022-07-02-183608.png" alt="iME4T0-2022-07-02-183608"  />
</p>
<p>选择 Surge 默认的设置点击<strong>完成</strong>即可，如果你发现这里路由地址为空（我一开始在这里卡了很久，后面发现选错了网络设备，选成了Ethernet Adapter (en6)），你就要检查一下哪里步骤出错了</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/eYfMhS-2022-07-02-183225.png" alt="eYfMhS-2022-07-02-183225"  />
</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/0qFKq7-2022-07-02-183745.png" alt="0qFKq7-2022-07-02-183745"  />
</p>
<p>启动完 DHCP 服务器之后可以看到设备列表没有任何设备，这时需要重启一下路由器或者让你想使用的设备重新连接一下wifi，就可以在新增设备中看到</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/R6rAZy-2022-07-02-184417.png" alt="R6rAZy-2022-07-02-184417"  />
</p>
<h2 id="添加设备成员">添加设备成员<a hidden class="anchor" aria-hidden="true" href="#添加设备成员">#</a></h2>
<p>想要科学上网的设备可以右键选择设备名，然后选择 <strong>使用 Surge 作为网关</strong>，然后<strong>设备重新连接wifi或者关闭路由器 wifi 再打开</strong>即可。</p>
<p>没连接上会显示等待连接，这里建议把<strong>设置固定 IP 地址</strong>也选上，这时官网推荐的做法，方便以后设备管理和连接。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/PLnbhq-2022-07-02-184957.png" alt="PLnbhq-2022-07-02-184957"  />
</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/m9E18F-2022-07-02-184849.png" alt="m9E18F-2022-07-02-184849"  />
</p>
<p>苹果手机和平板，由于注重隐私的原因会默认在连接 Wifi 的时候选上使用私有无线局域网地址进行连接（使用私有地址有助于减少不同无线局域网对 iPhone 的跟踪），<strong>这里需要把这个选项关掉重新连接 wifi 才能让 Surge 识别出你的设备</strong>。</p>
<div align="center"><img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/OwVf1i-2022-07-02-190701.png" alt="OwVf1i-2022-07-02-190701" style="zoom:25%;" /><img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/70fZUl-2022-07-02-190929.png" alt="70fZUl-2022-07-02-190929" style="zoom:25%;" /><img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/EiIKd0-2022-07-02-191059.png" alt="EiIKd0-2022-07-02-191059" style="zoom:25%;" />
</div><br>
<p>如果不清楚 IP 地址具体对应哪台设备，可以到路由器管理后台查看或者根据此 IP 的制造商进行推断。</p>
<p>最后推荐将设备连接Wifi的IPV4地址改为手动，因为你如果你启用了自动DHCP的话，有可能下次连接这个WIFI时IP地址就会改变，如果连接失败，可以按照以下的配置将IPV4地址改为手动即可。</p>
<img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/IMG_2A213714640D-1-2022-07-05-221811.jpeg" alt="IMG_2A213714640D-1-2022-07-05-221811" style="zoom: 25%;" />
<p><strong>至此，家里的想要一起科学上网的设备都可以通过 Mac 电脑这个网络枢纽一起愉快玩耍了！</strong></p>
<h1 id="特殊情况">特殊情况<a hidden class="anchor" aria-hidden="true" href="#特殊情况">#</a></h1>
<blockquote>
<p>一开始使用的时候，我遇到过用surge作为网关的 Mac 可以打开网页的 youtube 视频并且能观看，但是家里其他设备通过wifi连接的缺不能访问 google，检查一下是可以打开 youtube App，但是只能看到视频的缩略图，进一步点击打开视频观看，却始终是 loading状态，无法观看。奇怪的是可以打开Netflix，正常看剧。</p>
</blockquote>
<p>这种情况查找到解决的办法是，在你需要访问 YouTube 的设备上把连接的 wifi 的 DNS配置修改一下，从自动改为手动，并添加一个 DNS 服务器 192.0.2.2</p>
<div align="center"><img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/9pLUgY-2022-07-02-191508.png" alt="9pLUgY-2022-07-02-191508" style="zoom:25%;" /><img src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/D4hRaT-2022-07-02-191714.png" alt="D4hRaT-2022-07-02-191714" style="zoom:25%;" />
</div><br>
<div align="center"> </div>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/lmingyul/lmingyul.github.io@uPic/uPic/YrtDRs-2022-07-02-192758.png" alt="YrtDRs-2022-07-02-192758"  />
</p>
<p>至于为什么设置为这个DNS地址我也不是很清楚，只知道手册上是这样写的🐶，这样就把 YouTube 不能访问的问题就解决了！</p>
<hr>
<h1 id="总结">总结<a hidden class="anchor" aria-hidden="true" href="#总结">#</a></h1>
<p>以后有其他设备想要愉快上网，都可以通过这台被 Surge 附魔的 Mac 电脑作为转发代理，省下了加速器的年费，还比加速器好使，覆盖范围更广。</p>
<p>这篇文章只是简单使用了 Surge 的简单功能（规则访问策略并没有定制化），用户还可以对 Surge 进行很多定制化的改造，这些更深入的功能就等以后慢慢发掘吧，先去愉快地玩我新到的 Switch 啦，有什么好玩的游戏，欢迎推荐！</p>
<hr>
<h1 id="参考资料">参考资料<a hidden class="anchor" aria-hidden="true" href="#参考资料">#</a></h1>
<ul>
<li><a href="https://qust.me/post/MacSurgeRouter/#surge-dhcp-%E6%8E%A5%E7%AE%A1%E7%BD%91%E7%BB%9C">Surge 把你的 Mac 变成最强路由器</a></li>
<li><a href="https://surge.mitsea.com/others/gateway-mode">Surge 使用手册</a></li>
<li><a href="https://github.com/bannedbook/fanqiang/blob/master/ios/Surge.md">Surge 教程</a></li>
<li><a href="https://community.nssurge.com/">Surge 论坛</a></li>
<li><a href="https://blog.indigo.codes/2020/04/24/home-network-deployment/">家庭网络部署心得</a></li>
</ul>


    </div>

    <footer class="post-footer">
        <ul class="post-tags">
            <li><a href="http://www.lmingyu.tech/tags/surge/">Surge</a></li>
            <li><a href="http://www.lmingyu.tech/tags/switch/">Switch</a></li>
            <li><a href="http://www.lmingyu.tech/tags/%E6%95%99%E7%A8%8B/">教程</a></li>
        </ul>
<nav class="paginav">
  <a class="next" href="http://www.lmingyu.tech/posts/tech/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
    <span class="title">Next »</span>
    <br>
    <span>Linux常用命令</span>
  </a>
</nav>

    </footer><script src="https://utteranc.es/client.js"
        repo="lmingyul/lmingyul.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="http://www.lmingyu.tech">Mingyu&#39;s Blog</a></span>
    <span>
        <a href="http://beian.miit.gov.cn" target="_blank" style="color: #939393">粤ICP备2022085443号</a>
    </span>
    <span id="busuanzi_container_site_pv">
    本站点击访问量：<span id="busuanzi_value_site_pv"></span>次
    </span>
    &nbsp;
    <span id="busuanzi_container_site_uv">
        您是第 <span id="busuanzi_value_site_uv"></span> 位光临本站的小可爱，欢迎👏🏻！！！
    </span>

</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <img src="/img/rocket.webp" alt="top">




</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {
            }
            ;
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
